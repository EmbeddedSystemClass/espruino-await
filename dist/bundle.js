function t(t){return new Promise(function(n){return setTimeout(n,t)})}function n(){return(new Date).getTime()}function e(t){var e=n()-a;console.log("["+e.toFixed(0)+"]",t)}function r(){return new Promise(function(t,n){return o().then(function(r){return i().then(function(r){return u().then(function(r){return c().then(function(n){return e("All tests finished"),t()}.$_ab(this,n),n)}.$_ab(this,n),n)}.$_ab(this,n),n)}.$_ab(this,n),n)}.$_ab(this))}function o(){return new Promise(function(n,r){return e("test seq"),t(s.delay).then(function(t){return e(s.delay+" ms passed"),n()}.$_ab(this,r),r)}.$_ab(this))}function i(){return new Promise(function(n,r){function o(){return u<=10?(e(u),t(s.delay).then(function(t){return i}.$_ab(this,r),r)):[1]}function i(){return u++,o}var u;return e("test loop"),u=1,Function.$_ab.trampoline(this,function(){return n()},i,r,!0)(o)}.$_ab(this))}function u(){return new Promise(function(n,r){var o,i,u;e("test throw"),o=function(){return new Promise(function(n,e){return t(500).then(function(t){return e(new Error("OK"))}.$_ab(this,e),e)}.$_ab(this))},i=function(){return t(500).then(function(t){return n()}.$_ab(this,r),r)}.$_ab(this,r),u=function(t){return e("Catched"),i()}.$_ab(this,r);try{return o().then(function(t){return e("Error2"),i()}.$_ab(this,u),u)}catch(t){u(t)}}.$_ab(this))}function c(){return new Promise(function(t,n){return e("test recursive"),f(5).then(function(n){return t()}.$_ab(this,n),n)}.$_ab(this))}function f(t){return new Promise(function(n,e){return t<0?n():f(--t).then(function(t){return n()}.$_ab(this,e),e)}.$_ab(this))}var s={delay:100},a=n(),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Function.prototype.$_ab=function t(n,e){function r(){return o.apply(n,arguments)}Function.prototype.$_ab||Object.defineProperty(Function.prototype,"$_ab",{value:t,enumerable:!1,configurable:!0,writable:!0}),t.trampoline||(t.trampoline=function(t,n,e,r,o){return function i(u){for(;u;){if(u.then)return u=u.then(i,r),o?void 0:u;try{if(u.pop){if(u.length)return u.pop()?n.call(t):u;u=e}else u=u.call(t)}catch(t){return r(t)}}}}),t.LazyThenable||(t.LazyThenable=function(){function t(t){return t&&t instanceof Object&&"function"==typeof t.then}function n(e,r,o){try{var i=o?o(r):r;if(e===i)return e.reject(new TypeError("Promise resolution loop"));t(i)?i.then(function(t){n(e,t)},function(t){e.reject(t)}):e.resolve(i)}catch(t){e.reject(t)}}function e(t){}function r(){}function o(e,o){var i=new r;try{this._resolver(function(r){return t(r)?r.then(e,o):n(i,r,e)},function(t){n(i,t,o)})}catch(t){n(i,t,o)}return i}function i(t){this._resolver=t,this.then=o}return r.prototype={resolve:e,reject:e,then:function(t,n){this.resolve=t,this.reject=n}},i.resolve=function(t){return i.isThenable(t)?t:{then:function(n){return n(t)}}},i.isThenable=t,i}(),t.EagerThenable=t.Thenable=(t.EagerThenableFactory=function(t){function n(t){if(t){var n=this;t(function(t){n.resolve(t)},function(t){n.reject(t)})}}function e(t,n){if("function"==typeof t.y)try{var e=t.y.call(void 0,n);t.p.resolve(e)}catch(n){t.p.reject(n)}else t.p.resolve(n)}function r(t,n){if("function"==typeof t.n)try{var e=t.n.call(void 0,n);t.p.resolve(e)}catch(n){t.p.reject(n)}else t.p.reject(n)}t=t||"object"===("undefined"==typeof process?"undefined":h(process))&&process.nextTick||"function"==typeof setImmediate&&setImmediate||function(t){setTimeout(t,0)};var o=function(){function n(){for(;e.length-r;){try{e[r]()}catch(t){}e[r++]=void 0,r===o&&(e.splice(0,o),r=0)}}var e=[],r=0,o=1024;return function(o){e.push(o),e.length-r==1&&t(n)}}();return n.prototype={resolve:function(t){var n,r,i;if(void 0===this.state){if(t===this)return this.reject(new TypeError("Attempt to resolve promise with self"));if(n=this,t&&("function"==typeof t||"object"===(void 0===t?"undefined":h(t))))try{if(r=0,"function"==typeof(i=t.then))return void i.call(t,function(t){r++||n.resolve(t)},function(t){r++||n.reject(t)})}catch(t){return void(r||this.reject(t))}this.state=e,this.v=t,n.c&&o(function(){for(var r=0,o=n.c.length;r<o;r++)e(n.c[r],t)})}},reject:function(t){if(void 0===this.state){this.state=r,this.v=t;var n=this.c;n&&o(function(){for(var e=0,o=n.length;e<o;e++)r(n[e],t)})}},then:function(t,e){var r,i,u=new n,c={y:t,n:e,p:u};return void 0===this.state?this.c?this.c.push(c):this.c=[c]:(r=this.state,i=this.v,o(function(){r(c,i)})),u}},n.resolve=function(t){if(t&&t instanceof n)return t;var e=new n;return e.resolve(t),e},n.reject=function(t){if(t&&t instanceof n)return t;var e=new n;return e.reject(t),e},n.version="2.3.3-nodent",n})());var o=this;switch(e){case!0:return new t.Thenable(r);case 0:return new t.LazyThenable(r);case void 0:return r.then=r,r;default:return function(){try{return o.apply(n,arguments)}catch(t){return e(t)}}}},e("Mode: production"),r();
